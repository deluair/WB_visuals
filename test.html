<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test World Bank Visualizer</title>
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
</head>
<body>
    <h1>World Bank API Test</h1>
    <div id="test-results"></div>
    <div id="map" style="height: 400px;"></div>

    <script>
        console.log('Testing World Bank Data Visualizer...');
        
        // Test 1: Basic map creation
        try {
            var map = L.map('map').setView([20, 0], 2);
            L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
                attribution: '¬© OpenStreetMap contributors'
            }).addTo(map);
            console.log('‚úÖ Map created successfully');
            document.getElementById('test-results').innerHTML += '<p>‚úÖ Map created successfully</p>';
        } catch (error) {
            console.error('‚ùå Map creation failed:', error);
            document.getElementById('test-results').innerHTML += '<p>‚ùå Map creation failed: ' + error.message + '</p>';
        }

        // Test 2: World Bank API call
        async function testAPI() {
            try {
                console.log('Testing World Bank API...');
                const response = await fetch('https://api.worldbank.org/v2/country/USA/indicator/SP.POP.TOTL?date=2022&format=json');
                
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                
                const data = await response.json();
                console.log('‚úÖ API call successful:', data);
                document.getElementById('test-results').innerHTML += '<p>‚úÖ World Bank API accessible</p>';
                
                if (Array.isArray(data) && data.length > 1 && data[1] && data[1].length > 0) {
                    const value = data[1][0].value;
                    document.getElementById('test-results').innerHTML += `<p>üìä USA Population 2022: ${value}</p>`;
                }
                
            } catch (error) {
                console.error('‚ùå API call failed:', error);
                document.getElementById('test-results').innerHTML += '<p>‚ùå API call failed: ' + error.message + '</p>';
            }
        }

        // Test 3: Country coordinates
        const testCoordinates = {
            'USA': [37.0902, -95.7129],
            'CHN': [35.8617, 104.1954],
            'GBR': [55.3781, -3.4360]
        };

        try {
            Object.keys(testCoordinates).forEach(country => {
                const coords = testCoordinates[country];
                L.circleMarker(coords, {
                    radius: 10,
                    fillColor: '#007bff',
                    color: '#fff',
                    weight: 2,
                    opacity: 1,
                    fillOpacity: 0.8
                }).addTo(map).bindPopup(country);
            });
            console.log('‚úÖ Markers added successfully');
            document.getElementById('test-results').innerHTML += '<p>‚úÖ Markers added successfully</p>';
        } catch (error) {
            console.error('‚ùå Marker creation failed:', error);
            document.getElementById('test-results').innerHTML += '<p>‚ùå Marker creation failed: ' + error.message + '</p>';
        }

        // Run API test
        testAPI();

        console.log('üéØ All tests completed. Check results above.');
    </script>
</body>
</html> 